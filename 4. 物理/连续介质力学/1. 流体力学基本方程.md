
## 流体力学|专题（1）N-S方程组的推导

### 引言

又是一个新专题！

坑越来越多了orz

这个专题将会涉及一些零散的流体力学内容。

在我有限的了解下，流体力学并不像一门典型的物理课（也有可能是我之前学的物理都太初等了hhhh),它似乎大部分时间都在进行各种张量运算、物质积分的推导、Lagrange表述与Euler表述的转换等等。换句话说，难度往往在对于物理对象的数学描述而非物理认识上。因此在繁杂的数学推导中寻找有限的物理图像可能就比较重要了。这会是文章着眼的重点。

此外，对于流体力学中用到的数学工具，例如场论、张量、曲面坐标系，也会在之后慢慢寻找合适又有趣的角度进行适当的介绍。



本专题的推导对于零基础同学不太友好，需要对于场论、物质场的Lagrange描述和Eular描述、张量运算有一定的熟悉。

### 连续性方程

最自然的推导方式应该是**欧拉描述的物质守恒**plus**随体导数**

考虑一个空间速度场中的区域$\Omega$中密度的变化,。由于我们选取的区域是不随时改变的，即采用拉格朗日描述，则**物理量关于时间的微分并非不含随体项**，也就是这些**物理量都视为关于空间坐标的函数，而非关于流体质点的函数**。

于是由于物质守恒，区域中质量的变化等于边界进入的质量与流出的质量之差，从而有：
$$
\frac{\partial}{\partial t}\int_\Omega \rho dx 
= -\int_{\partial \Omega}\rho \vec{v} d\vec{S}
$$
对等式右端项使用Gauss公式，并考虑到积分区域的任意性化为微分形式：
$$
\frac{\partial \rho}{\partial t} + \nabla·(\rho\vec v) = 0
$$
这便是连续性方程的微分形式。

考虑到随体导数和非随体导数的关系：
$$
\frac{d\rho}{dt}=\frac{\partial \rho}{\partial t}+\vec v·(\nabla \rho)
$$
连续性方程还可以化为：
$$
\frac{d\rho}{dt}+\rho \nabla\vec v = 0
$$
不可压缩流体的定义为：
$$
\frac{d\rho}{dt} = 0
$$
因此对于不可压缩流体，连续性方程变为：
$$
\nabla\vec v = 0
$$
注意，这里的$\frac{d\rho}{dt}$是针对给定流体质点而言，即对于确定的某一质点，其密度不随时间改变，但不代表不同质点的密度都相等——事实上，若将该条件也加入，则流体密度场在全空间任意时刻均为常数。

### 动量守恒方程与本构关系

考虑速度场与密度场的拉格朗日描述。

此时依然选取一区域$\Omega$，由于采用拉格朗日描述，可以将该**区域视为随时间发生改变的流体微团**，此时需要考虑**物质积分的随体导数**。

由动量定理，单位时间流体微团的动量变化量应等于流体微团在整个内部受到的体力冲量与边界处的面力(此处为应力张量在法向的投影）冲量之和：
$$
\frac{d}{dt}\int_\Omega{\rho \vec{v}dx} 
=\int_{\partial \Omega}{p_n d\vec{S}}+\int_\Omega{\vec f}dx
$$
注意应力方向法向投影指向流体微团内部数值为正。

等式左端项：
$$
= \int_\Omega{\rho \frac{d\vec{v}}{dt}dx}
 +\int_\Omega{\vec v \frac{d}{dt}(\rho dx)} \\
 \xlongequal{质量守恒}\int_\Omega{\rho \frac{d\vec{v}}{dt}dx}+0 \\
 = \int_\Omega{\rho \frac{d\vec{v}}{dt}dx}
$$

等式右端第一项：
$$
\xlongequal{Gauss公式} \int_\Omega {\nabla· P dx}
$$
其中P为应力张量（二阶张量）

结合以上三式，利用积分区域$\Omega$的任意性，有：
$$
\rho \frac{d\vec v}{dt} = \nabla ·P + \rho \vec f
$$
其中右端两项分别为**面力项**与**体力项**。一般地，体力项的形式有赖于具体问题，比较常见的情形是包含重力项。

接下来考虑**应力张量**。一般地，应力张量与速度变形张量or应变张量的关系称为本构关系，通常由介质本身的性质决定。受牛顿流体的一维流动的牛顿黏性定律启发，预期“广义牛顿黏性定律”：应力张量与速度变形张量有线性关系。

首先给出几个基本假设，借助这些假设我们将导出牛顿流体的本构关系：

1）流动流体的应力张量在速度趋近于0时，应力张量趋近于静止流体的应力张量。

​	此条假设可以理解为某种连续性，是比较自然比较直观的。

2）如上所述“应力张量”与速度变形张量具有线性关系，不过考虑到条件（1），我们可以将该假设表述为**偏应力**张量与速度变形张量具有**齐次**线性关系。

所谓偏应力张量的引入方式也并非突兀：
$$
P \stackrel{def}{=}-pI+\Pi
$$
p为流体静压力，根据假设（1）$\Pi$在流体静止时为0。

此条假设的insight其实也不难考虑：将一维牛顿黏性定律“线性叠加”即可得到。

3）流体具有各向同性。

尽管我们这里只需要用到力学性质的各项同性，事实上对于大部分情形（几乎全部的气体以及大部分的简单液体），介质的各个物理性质都可以假设为各向同性（例如黏性、导热率、扩散系数）。对于某些液体——例如某些大分子长链状悬浮液，各向同性假设并不能被满足（事实上此时液体也往往并非牛顿流体，这意味着假设（2）同样会出问题）

由于偏应力张量关于速度变形张量的各向同性，原本$3^2 * 3^2 =81$**个自由度** 的应力-应变速率线性依赖关系就 **变为了2个自由度** （通过一些dirty的张量运算可以证明，目前我还没有发现什么直观又自然的方法来严格的说清，这里我们暂且接受它吧）



值得一提的是，这三条假设的提出者正是斯托克斯。



由于只有两个自由度两个未知数，我们直接给出偏应力张量的形式再给出说明：
$$
\Pi = 2\mu S+ \lambda tr(S)I = 2\mu S+ \lambda (\nabla ·\vec v)I
$$
这里引入的新的张量$S$,这是一个二阶对称张量，是来自速度变形张量的对称分量：
$$
u_{i,j}=1/2(u_{i,j}+u_{j,i})+1/2(u_{i,j}-u_{j,i})\\
=S+A
$$
这里的$S$ 与 $A$有较为重要的物理意义，但姑且按下不表，之后再集中讨论。

如果我们代入一维流动的条件：
$$
v = w = 0, u = u(y)
$$
立刻得到这里的$\mu$即为牛顿黏性定理的黏性，此即为我们这样定义的原因。

值得一提的是，这里的$\mu$一般称为**动力学粘性系数**，此外还有一个**运动学黏性系数**,定义为：
$$
\nu = \frac{\mu}{\rho}
$$
运动学黏性系数可能在之后更加常见。

此外，若引入：
$$
\mu' = \lambda + 2/3 \mu
$$
则有：
$$
P = \Pi -pI = (\lambda(\nabla ·\vec v)-p)I+2\mu S \\
= 2(\mu S -\frac{1}{3}\mu(\nabla·\vec v))+\mu'(\nabla·\vec v)-pI
$$
于是：
$$
tr(P) =\mu'(\nabla·\vec v)-pI
$$
这里应力张量P的迹的物理含义为x,y,z三个方向上的平均法向应力。下面进行一些不严谨的论证：根据线性代数理论，tr(·)是对称张量P的正交相似不变量，也就是说tr(P)可以代表任意三个正交方向上的平均法向应力，于是对所有方向，按照三个三个正交的分组，分为“无穷多组”，我们得到tr(P)实际上就是所有方向上的平均法向应力。

对于不可压缩的流体，我们有：
$$
\nabla ·\vec v = 0
$$
这表明对于不可压缩的流体，其平均法向应力是个常数，其中$\mu'$并不出现。而在数学的角度上，则体现为本构方程中只有一个自由度，即动力学黏性系数。

由于$\mu'$的特殊性，我们将其称为**第二动力学黏性系数**，他在不可压缩流体中并不体现其物理含义。或者换句话说，它本身就是一个区分可压缩与不可压缩流体的指标。

**那么，在可压缩流体中，第二动力学黏性系数又有怎样的物理意义呢？这个问题同样先按下不表，留待之后讨论。**

最后，我们将Stokes给出的三条假设公理所演绎出的应力-应变速率关系（本构关系）代回最初的动量守恒方程，得到：
$$
\rho\frac{d\vec v}{dt} = \nabla ·(\Pi-pI)+\rho \vec f \\
 = \nabla ·(\mu(\nabla \vec v + \vec v \nabla)+ \lambda(\nabla · \vec v)I-pI) + \rho \vec f
$$

### 能量方程

最后来考虑能量方程。

我们构建能量方程依然采用拉格朗日描述，物质微团$\Omega$的总能量变化等于外界做功与传热之和。

- 流体微团的总能量(动能与内能）：

$$
\int_\Omega{\rho (U+\frac{v^2}{2})dx}
$$

其中U表示单位质量的内能。

- 外界对流体微团做的功（面力与体力）：

$$
\int_{\partial \Omega}{p_n · \vec{v} dx} + \int_\Omega{\vec f · \vec v dx} \\
\int_\Omega{\nabla · (\vec v · P)+\vec f · \vec v dx}
$$

- 外界向流体微团传热：
  $$
  \int_{\partial \Omega}{-\vec q · d\vec{S}} \xlongequal{fourier传热定律}\int_{\partial \Omega}-{(-\kappa \nabla T)·d{\vec S}}\\
  = \int_\Omega{\nabla ·(\kappa \nabla T)dx}
  $$

注意在最一般的情形下，传热率$\kappa$是一个二阶张量，只有在各向同性的条件下才可以视为标量（退化情形）

- 流体微团自身产热：
  $$
  \int_\Omega{\rho q dx}
  $$

其中$q$为单位质量产热率。

于是由能量守恒：
$$
\int_\Omega ({\nabla ·(\vec v ·P)+\vec f · \vec v - \nabla·(\kappa \nabla T)+\rho q})\\
= \frac{d}{dt}\int_\Omega{\rho(U+\frac{V^2}{2})dx}\\
=  \int_\Omega{\rho \frac{d}{dt}(U+\frac{V^2}{2})dx} + \int_\Omega{(U+\frac{V^2}{2})\frac{d}{dt}(\rho dx)}\\
\xlongequal{质量守恒} \int_\Omega{\rho \frac{d}{dt}(U+\frac{V^2}{2})dx}
$$
等式左边的四项，其物理意义都非常明显，分别是面力功项、体力功项、热传导项以及热源项。

同样地，我们从积分区域的任意性得到：
$$
\nabla ·(\vec v ·P)+\vec f · \vec v + \nabla·(\kappa \nabla T)+\rho q =\rho \frac{d}{dt}(U+\frac{v^2}{2})
$$
距离终点已经很近了，下面不加证明的给出：(似乎也只能通过Einstein张量表示法化简的方式验证？)
$$
\nabla ·(\vec v ·P) = (\nabla · P)· \vec v + P :S
$$
这里$P :S$表示的是张量的缩并运算。

于是由：
$$
(\nabla · P)· \vec v +\vec f · \vec v  = \rho \frac{d}{dt}\frac{v^2}{2}
$$
（上式记为动量守恒方程）

得到：
$$
\rho \frac{dU}{dt} = P :S + \nabla ·(\kappa \nabla T)+ \rho q
$$
大功告成！我们终于得到了N-S方程组的全部内容：
$$
\left\{
\begin{array}{}
\frac{d\rho}{dt}+\rho \nabla\vec v = 0 \\
\rho\frac{d\vec v}{dt} = 2(\mu S -\frac{1}{3}\mu(\nabla·\vec v))+\mu'(\nabla·\vec v)-pI+ \rho \vec f\\
\rho \frac{dU}{dt} = P :S + \nabla ·(\kappa \nabla T)+ \rho q \\
p = f(T,\rho)
\end{array}
\right.
$$
最后一项就是所谓的状态方程。

当然，我们还有不少遗留问题没有解决，例如——$P:S$又有什么物理含义？

不过这篇笔记已经过长了，剩下的话题，就留待之后再说吧。



<!--stackedit_data:
eyJoaXN0b3J5IjpbMTUzMDY1NzA4NiwtMTIyMzYxNzgyNl19
-->