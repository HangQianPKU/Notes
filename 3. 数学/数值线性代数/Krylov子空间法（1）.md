# 特征值问题——Krylov子空间法

## 一. 问题的提法

Krylov子空间法本质的想法是，对于一个大规模的问题：
$$
Ax=b
$$
如果A的阶数n太大，我们试图找到一个较小的k维子空间$\mathscr{K}_k$，将问题投影到这个空间上来解决。

因此，Krylov子空间法与其说是一种算法，不如说是一种解决问题的思路。后面我们会看到，Krylov子空间的方法绝不仅仅限于特征值问题的求解。

“降维”，这就是我们想做的事。

于是引出了两个问题：

1.如何寻找这样的子空间？

2.如何进行投影？投影怎么用数学（矩阵）语言描述？



关于第一个问题，我们通常采用的子空间是所谓的Krylov子空间：
$$
\mathscr{K}_k = \{v,Av,A^2v,...,A^{k-1}v\}
$$
或许这个花体的字母$\mathscr{K}$就是krylov的简写吧。

这样选取的好处有几点：

1.信息量小，我们只需要用到一个矩阵A

2.便于计算——这是由我们针对的具体问题决定的，因为我们通常运用Krylov子空间方法的场景是大规模稀疏矩阵，可以充分利用A的稀疏性。

3.便于扩张：这是很显然的，由于：
$$
\mathscr{K_{k+1}} = \mathscr{K_k}+span\{A^{k}v\}
$$


下一个问题是，如何进行投影？

考虑到投影的几何意义，采用线性变换的观点是比较自然的想法：

考虑$\R^n$上的线性变换：
$$
\mathscr{A}:R^n \longrightarrow R^n \\
             x  \mapsto  Ax
$$
在什么意义上，我们考虑“变换的投影”？

可以这样想，由于Krylov子空间未必是A的特征子空间，（例如，其中的元素$A^{k-}v$经过变换就有可能跑出去。因此，我们考虑，**变换$\mathscr{A}$在Krylov子空间上的限制与对Krylov子空间上的投影变换的复合**,其实仔细想想，这倒也挺自然的——如果我们要研究的Krylov子空间是A的不变子空间，反映在矩阵上就是可以将原矩阵分块——那么我们只需要去除那个分块之后的小矩阵来研究就好了。若非不变子空间，那自然将经过变换后“跑出去”的向量再投影回来，直观上也是非常合理的。而所谓“矩阵的投影”，其实就是这个新的复合变换在Krylov子空间的一组正交基下的表出。

现在我们来试着对这个过程进行描述。

**1.投影变换的矩阵描述**

取Krylov子空间的一组单位正交基$q_1,...q_k$，将他们排成矩阵的形式。由于幺正的条件，有：
$$
Q_k = (q_1,q_2,...q_k),Q_k^TQ_k= I
$$
投影变换$\mathscr{P}$在这组基下的矩阵表示为：$Q_kQ_k^T$   。

这是因为，对于任意$X \in R^n$,其在子空间中的投影为：
$$
(q_1,q_2,,,,q_k)
\left(\begin{array}{}q_1^TX\\q_2^TX\\q_3^TX\\ \vdots \\q_k^TX   \end{array} \right)  \\
\xlongequal{矩阵分块乘法}(q_1,q_2,,,,q_k) \left(\begin{array}{}q_1^T\\q_2^T\\q_3^T\\ \vdots \\q_k^T   \end{array} \right)X \\
= Q_kQ_k^TX
$$
从而投影变换对应的矩阵为$Q_kQ_k^T$

**2.在子空间中向量的描述**：

这并不困难，$X$在子空间中当且仅当存在$Y\in R^k$，使得：
$$
X = Q_kY
$$
于是我们有：
$$
\mathscr{P} \circ\mathscr{A_{|\mathscr{K_k}}}(Q_kY) = Q_kQ_k^TAQ_kY
$$
从而：
$$
\mathscr{P} \circ\mathscr{A_{|\mathscr{K_k}}}Q_k = Q_k(Q_k^TAQ_k)
$$
其实写到这里问题已经解决了，为了看得更清楚些，给出：
$$
\mathscr{P} \circ\mathscr{A_{|\mathscr{K_k}}} (q_1,q_2,...q_k) = (q_1,q_2,...q_k)(Q_k^TAQ_k)
$$
如果对于线性变化在给定基下的表出比较熟悉，很容易看出这意味着，**$H_k =Q_kA^TQ_k $刚好是变换$\mathscr{P} \circ\mathscr{A_{|\mathscr{K_k}}}$在子空间的单位正交基$\{q_1,q_2,...q_k\}$下的矩阵表示。**

回过来看看整个证明，略微有些tricky的部分在于，我们是在$\R^n$上进行线性变换，因此有时向量会视为坐标，有时则将向量视为线性空间中的元素。



总之，这样我们便将研究矩阵$A$的问题转化到研究小矩阵$H_k$上了。

## 二.特征值问题

现在来看特征值问题：

假设有：
$$
X = Q_kY+V \approx Q_kY
$$
那么若：
$$
AX = \lambda X
$$
即：
$$
\lambda X = AX \approx AQ_kY
$$
则有：
$$
H_kY = Q_k^TAQ_kY \approx Q_k^T(\lambda Q_kY) = \lambda Y
$$
这告诉我们，若$(\lambda,Y)$是$H_k$的特征对，我们便可以用$(\lambda,Q_kY)$来逼近$A$的特征对。

从而我们将大型的特征值问题：
$$
AX= \lambda X
$$
转化为了小型的特征值问题：
$$
H_kX = \lambda X
$$

问题的提法给出了，接下来我们将展开对其的讨论。具体而言，需要解决的问题有以下几个：

1.如何计算正交基矩阵$Q_k$？ ——不能选取生成子空间的基（条件数会快速增长），Arnoldi分解，Lanczos分解

2.如何选取、选取那些矩阵$H_k$的特征对以逼近原问题的特征对呢？——正交投影法，Rayleigh-Riesz投影

3.如何选取子空间$\{v,Av,A^2v,...,A^{k-1}v\}$的向量$v$以及迭代次数k呢

4.逼近精度如何？逼近精度如何依赖于问题的参数？

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTQzNTIzOTMzNl19
-->